(this["webpackJsonpblog-app"]=this["webpackJsonpblog-app"]||[]).push([[0],{164:function(e,t,a){e.exports=a(267)},170:function(e,t,a){},240:function(e,t,a){},267:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(4),c=a.n(i),l=a(14),o=a(10),s=a(15),u=a(16),m=a(17),p=a(111),d=a.n(p),h=a(144),b=a(157),g=a(54),y=a(41),f=a(292),v=a(290),E=(a(170),a(171),function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={current:"blogs"},a.handleClick=function(e){a.setState({current:e.key})},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e,t;return this.props.admin?(e="\u7ba1\u7406\u5458\u754c\u9762",t="/admin"):(e="",t="/"),r.a.createElement("div",{className:"BlogHeader",style:{backgroundImage:"url(/header.jpg)",backgroundSize:"100% 100%"}},r.a.createElement("div",{style:{position:"absolute",left:"20px",top:"40px"}},r.a.createElement(y.b,{to:t},r.a.createElement("h1",null,e))),r.a.createElement("div",{style:{position:"absolute",bottom:"0px",right:"0px",backgroundColor:"transparent"}},r.a.createElement("div",{className:"MenuFontStyle",onClick:function(){window.location=t}},r.a.createElement("p",{style:{display:"inline",userSelect:"none"}},"Blogs")),r.a.createElement("div",{className:"MenuFontStyle",onClick:function(){window.location="/resources"}},r.a.createElement("p",{style:{display:"inline",userSelect:"none"}},"Resources")),r.a.createElement("div",{className:"MenuFontStyle",onClick:function(){window.location="/live"}},r.a.createElement("p",{style:{display:"inline",userSelect:"none"}},"Live"))))}}]),t}(r.a.Component)),j=a(293),x=a(31),O=a.n(x),k=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={tags:[]},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;O.a.ajax({url:"/api/blog/tags",success:function(t){e.setState({tags:t})}}),console.log("sidebar mounted")}},{key:"render",value:function(){var e;return e=this.props.admin?"/admin/posts/":"/posts/",r.a.createElement(j.a,{itemLayout:"horizontal",style:{marginTop:"25px"},dataSource:this.state.tags,renderItem:function(t){return r.a.createElement(j.a.Item,{style:{height:"60px"},align:"left"},r.a.createElement(j.a.Item.Meta,{title:r.a.createElement(y.b,{to:e+t.tag},r.a.createElement("span",null,t.tag))}))}})}}]),t}(r.a.Component),w=a(300),S=a(289),I=a(287),C=a(294),T=a(288),F=a(296),M=a(286),D=(a(240),function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"handleDelete",value:function(){console.log(this.props.index),O.a.ajax({url:"/api/blog/article/"+this.props.index,type:"DELETE",headers:{"x-access-token":localStorage.getItem("token")},success:function(e){console.log(e),window.location.reload(),F.a.info("\u5220\u9664\u6210\u529f")},error:function(e){F.a.info("\u5220\u9664\u5931\u8d25")}})}},{key:"render",value:function(){var e;return e=this.props.admin?r.a.createElement("div",null,r.a.createElement(y.b,{to:"/admin/article/"+this.props.index},r.a.createElement(C.a,{size:"small"},"Edit")),r.a.createElement(M.a,{placement:"topRight",title:"Are you sure to delete this blog?",onConfirm:this.handleDelete.bind(this),okText:"Yes",cancelText:"No"},r.a.createElement(C.a,{size:"small"},"Delete"))):r.a.createElement(y.b,{to:"/article/"+this.props.index},r.a.createElement(C.a,{size:"small"},"Learn more")),r.a.createElement(w.a,{className:"card",style:{backgroundImage:"url(/cloudy-day.png)"}},r.a.createElement(I.a,null,r.a.createElement(T.a,{variant:"h5",component:"h2",style:{marginLeft:"20px"}},this.props.title),r.a.createElement("br",null),r.a.createElement(T.a,{variant:"body2",component:"p",style:{marginLeft:"20px"}},this.props.summary)),r.a.createElement(S.a,{style:{float:"right",marginRight:"20px"}},e))}}]),t}(r.a.Component)),z=a(69),B=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={blogs:[]},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(e,t){var a=this,n="";n="/"===this.props.match.path||"/admin"===this.props.match.path?"":this.props.match.params.category,O.a.ajax({url:"/api/blog/views",data:{tag:n},success:function(e){a.setState({blogs:e})}})}},{key:"componentDidUpdate",value:function(e,t){var a=this;if(this.props.match.url!==e.match.url){var n="";n="/"===this.props.match.path||"/admin"===this.props.match.path?"":this.props.match.params.category,O.a.ajax({url:"/api/blog/views",data:{tag:n},success:function(e){a.setState({blogs:e})}})}}},{key:"render",value:function(){var e;if(this.props.admin){var t=r.a.createElement(v.a,{item:!0,md:12,sm:12,xs:12,align:"center",key:"new"},r.a.createElement(z.a,{type:"primary",style:{display:"inline",width:"80%"},onClick:function(){window.location="/admin/article/new"}},"\u6dfb\u52a0"));e=(e=this.state.blogs.map((function(e){return r.a.createElement(v.a,{item:!0,md:12,sm:12,xs:12,key:e.id},r.a.createElement(D,{title:e.title,summary:e.summary,index:e.id,admin:!0}))}))).concat(t)}else e=this.state.blogs.map((function(e){return r.a.createElement(v.a,{item:!0,md:12,sm:12,xs:12,key:e.id},r.a.createElement(D,{title:e.title,summary:e.summary,index:e.id}))}));return r.a.createElement(v.a,{container:!0,direction:"row",justify:"space-evenly",alignItems:"flex-start",spacing:3},e)}}]),t}(r.a.Component),L=a(153),N=a.n(L),A=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={video:{src:"livesrc/live.m3u8"}},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("div",{style:{display:"inline-block",paddingTop:"20px"}},r.a.createElement(N.a,{autoplay:!0,src:this.state.video.src,height:"400px"})))}}]),t}(r.a.Component),R=a(298),J=a(295),K=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={title:"",tags:[],content:""},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;O.a.ajax({url:"/api/blog/article/"+this.props.index,success:function(t){var a=t;e.setState({title:a.title,tags:a.tags,content:a.content})}})}},{key:"render",value:function(){var e=J.a.Title,t=this.state.tags.map((function(e){var t=Math.floor(16777215*Math.random()).toString(16);return r.a.createElement(R.a,{color:"#"+t,style:{float:"right"},key:e},e)})),n=a(248)(this.state.content);return console.log(n),r.a.createElement("div",{style:{padding:"20px 50px 20px",objectFit:"cover",position:"relative",backgroundColor:"#FFFFFF"}},r.a.createElement("div",null,r.a.createElement(e,{style:{paddingBottom:"20px",textAlign:"center"}},this.state.title)),r.a.createElement("div",null,t),r.a.createElement("div",{style:{paddingTop:"50px",objectFit:"cover",position:"relative"}},r.a.createElement("div",{className:"content",dangerouslySetInnerHTML:{__html:n}})))}}]),t}(r.a.Component),V=a(297),W=a(291),H=V.a.TextArea,P=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={title:"",tags:[],summary:"",content:""},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){var e=this;"new"!==this.props.index&&O.a.ajax({url:"/api/blog/article/"+this.props.index,async:!1,success:function(t){var a=t;e.setState({title:a.title,tags:a.tags,summary:a.summary,content:a.content})}})}},{key:"handleClick",value:function(){var e=document.getElementById("titleInput").value,t=document.getElementById("tagsInput").value,a=document.getElementById("summaryInput").value,n=document.getElementById("contentInput").value;"new"===this.props.index?O.a.ajax({url:"/api/blog/articles",type:"post",headers:{"Content-Type":"application/json","x-access-token":localStorage.getItem("token")},data:JSON.stringify({title:e,tags:t,summary:a,content:n}),async:!1,success:function(e){alert("\u6dfb\u52a0\u5b8c\u6210\uff01"),window.location="/admin"},error:function(e){alert("\u6dfb\u52a0\u5931\u8d25")}}):O.a.ajax({url:"/api/blog/article/"+this.props.index,type:"put",headers:{"Content-Type":"application/json","x-access-token":localStorage.getItem("token")},data:JSON.stringify({title:e,tags:t,summary:a,content:n}),async:!1,success:function(e){alert("\u4fee\u6539\u5b8c\u6210\uff01"),window.location="/admin"},error:function(e){alert("\u4fee\u6539\u5931\u8d25")}})}},{key:"render",value:function(){var e=this.state.title,t=this.state.content;console.log(t);var a=J.a.Title;return r.a.createElement("div",{style:{padding:"20px 50px 20px",position:"relative"}},r.a.createElement("div",null,r.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u6807\u9898"),r.a.createElement(H,{id:"titleInput",placeholder:"set a title",defaultValue:e,rows:1})),r.a.createElement(W.a,null),r.a.createElement("div",null,r.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u6807\u7b7e"),r.a.createElement(H,{id:"tagsInput",placeholder:"set a title",defaultValue:this.state.tags.join(","),rows:1})),r.a.createElement(W.a,null),r.a.createElement("div",null,r.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u6458\u8981"),r.a.createElement(H,{id:"summaryInput",placeholder:"write summary",defaultValue:this.state.summary,autoSize:{minRows:1,maxRows:3}})),r.a.createElement(W.a,null),r.a.createElement("div",null,r.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u5185\u5bb9"),r.a.createElement(H,{id:"contentInput",placeholder:"markdown here",defaultValue:this.state.content,autoSize:{minRows:8,maxRows:38}})),r.a.createElement("div",{style:{paddingTop:"50px",position:"relative",textAlign:"center"}},r.a.createElement(z.a,{type:"primary",onClick:this.handleClick.bind(this)},"\u63d0\u4ea4"),r.a.createElement(z.a,{type:"primary",style:{marginLeft:"20px"},onClick:function(){window.location="/admin"}},"\u53d6\u6d88")))}}]),t}(r.a.Component),_=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(K,{index:this.props.match.params.id})}}]),t}(r.a.Component),q=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(P,{index:this.props.match.params.id})}}]),t}(r.a.Component),U=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={content:""},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(v.a,{container:!0,direction:"row",justify:"center",alignItems:"flex-start",spacing:3},r.a.createElement(v.a,{item:!0,md:3,sm:3,xs:12},r.a.createElement("div",{style:{padding:"10px 10px 10px"}},r.a.createElement(k,null))),r.a.createElement(v.a,{item:!0,md:9,sm:9,xs:12},r.a.createElement("div",{style:{padding:"10px 10px 10px"}},r.a.createElement(g.b,{exact:!0,path:["/posts/:category","/"],component:B}))))}}]),t}(r.a.Component),X=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={content:""},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(v.a,{container:!0,direction:"row",justify:"center",alignItems:"flex-start",spacing:3},r.a.createElement(v.a,{item:!0,md:3,sm:3,xs:12},r.a.createElement("div",{style:{padding:"10px 10px 10px"}},r.a.createElement(k,{admin:!0}))),r.a.createElement(v.a,{item:!0,md:9,sm:9,xs:12},r.a.createElement("div",{style:{padding:"10px 10px 10px"}},r.a.createElement(g.b,{exact:!0,path:["/admin/posts/:category","/admin"],render:function(e){return r.a.createElement(B,Object.assign({},e,{admin:!0}))}}))))}}]),t}(r.a.Component),Y=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(f.a,{maxWidth:"md"},r.a.createElement(E,{admin:!0}),r.a.createElement("div",null,r.a.createElement(g.b,{exact:!0,path:"/admin/article/:id",component:q}),r.a.createElement(g.b,{exact:!0,path:["/admin/posts/:category","/admin"],component:X})))}}]),t}(r.a.Component),G=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null)}}]),t}(r.a.Component),Q=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(A,null)}}]),t}(r.a.Component),Z=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return console.log(this.props),r.a.createElement(f.a,{maxWidth:"md"},r.a.createElement(E,null),r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/article/:id",component:_}),r.a.createElement(g.b,{exact:!0,path:["/resources"],component:G}),r.a.createElement(g.b,{exact:!0,path:["/live"],component:Q}),r.a.createElement(g.b,{exact:!0,path:["/posts/:category","/"],component:U})))}}]),t}(r.a.Component),$=a(42),ee=a(299),te=Object(n.createContext)();var ae=a(155),ne=a.n(ae),re=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={username:"",password:"",hidden:"hidden"},e.handleSubmit=e.handleSubmit.bind(Object($.a)(e)),e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=new FormData(e.target);a.set("username",document.getElementById("userInput").value),a.set("password",ne()(document.getElementById("pwdInput").value)),fetch("/api/blog/login",{method:"POST",body:a}).then((function(e){200===e.status?e.json().then((function(e){localStorage.setItem("token",e.token),window.location=t.props.location.state.prev})):alert("login failed")}))}},{key:"render",value:function(){return console.log(this.props),r.a.createElement(f.a,{maxWidth:"md"},r.a.createElement("form",{ref:"form",onSubmit:this.handleSubmit},r.a.createElement("h1",{style:{fontSize:"18px",textAlign:"center",lineHeight:"50px"}},"Login"),r.a.createElement(V.a,{placeholder:"username",id:"userInput",style:{margin:"10px 10px"}}),r.a.createElement(V.a.Password,{placeholder:"password",id:"pwdInput",style:{margin:"10px 10px"}}),r.a.createElement(z.a,{type:"primary",htmlType:"submit",block:!0,style:{margin:"10px 10px"}},"login")),r.a.createElement(ee.a,{id:"alertMsg",style:{visibility:"hidden"},message:"Error Text",type:"error"}))}}]),t}(r.a.Component);re.contextType=te;var ie=re,ce=a(151),le=function(){return r.a.createElement("div",{style:{textAlign:"center",height:"100%"}},r.a.createElement(ce.a,{size:"large",style:{position:"absolute",top:"50%"}}))},oe=a(156),se=a.n(oe),ue=function(){var e=Object(n.useState)({auth:!1,waiting:!0}),t=Object(b.a)(e,2),a=t[0],i=t[1];Object(n.useEffect)((function(){console.log(a.waiting),console.log("auth is "+a.auth),console.log("middle mounted")}));var c=function(){var e=Object(h.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=localStorage.getItem("token"))||i({auth:!1,waiting:!1}),e.next=4,se.a.get("/api/blog/authstate",{headers:{"x-access-token":t}}).then((function(e){200===e.status&&i({auth:!0,waiting:!1})})).catch((function(e){i({auth:!1,waiting:!1})}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(a.waiting)return c(),r.a.createElement(le,null);if(!1===a.auth){var l=window.location.pathname;return r.a.createElement(g.a,{to:{pathname:"/login",state:{prev:l}}})}return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:["/admin/resources","/admin/article/*","/admin/posts/*","/admin"],component:Y}),r.a.createElement(g.b,{exact:!0,path:["/live"],component:Z}))},me=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={auth:!1},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{backgroundImage:"url(/blue-snow.png)",backgroundRepeat:"repeat",height:"100%",overflowX:"scroll"}},r.a.createElement(y.a,null,r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:["/admin/resources","/admin/article/*","/admin/posts/*","/admin"],component:ue}),r.a.createElement(g.b,{exact:!0,path:["/resources","/article/*","/posts/*","/"],component:Z}),r.a.createElement(g.b,{exact:!0,path:["/live"],component:ue}),r.a.createElement(g.b,{exact:!0,path:["/login"],component:ie}))))}}]),t}(r.a.Component);c.a.render(r.a.createElement(me,null),document.querySelector("#root"))}},[[164,1,2]]]);
//# sourceMappingURL=main.07b77fcd.chunk.js.map