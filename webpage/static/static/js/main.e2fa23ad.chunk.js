(this["webpackJsonpblog-app"]=this["webpackJsonpblog-app"]||[]).push([[0],{182:function(e,t,a){e.exports=a(363)},188:function(e,t,a){},258:function(e,t,a){},363:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(4),c=a.n(i),l=a(14),o=a(10),s=a(15),u=a(16),m=a(17),p=a(122),d=a.n(p),h=a(161),b=a(175),g=a(56),y=a(42),f=a(388),v=a(386),E=(a(188),a(189),function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={current:"blogs"},a.handleClick=function(e){a.setState({current:e.key})},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e,t;return this.props.admin?(e="\u7ba1\u7406\u5458\u754c\u9762",t="/admin"):(e="",t="/"),r.a.createElement("div",{className:"BlogHeader",style:{backgroundImage:"url(/header.jpg)",backgroundSize:"100% 100%"}},r.a.createElement("div",{style:{position:"absolute",left:"20px",top:"40px"}},r.a.createElement(y.b,{to:t},r.a.createElement("h1",null,e))),r.a.createElement("div",{style:{position:"absolute",bottom:"0px",right:"0px",backgroundColor:"transparent"}},r.a.createElement("div",{className:"MenuFontStyle",onClick:function(){window.location=t}},r.a.createElement("p",{style:{display:"inline",userSelect:"none"}},"Blogs")),r.a.createElement("div",{className:"MenuFontStyle",onClick:function(){window.location="/resources"}},r.a.createElement("p",{style:{display:"inline",userSelect:"none"}},"Resources")),r.a.createElement("div",{className:"MenuFontStyle",onClick:function(){window.location="/live"}},r.a.createElement("p",{style:{display:"inline",userSelect:"none"}},"Live"))))}}]),t}(r.a.Component)),j=a(389),x=a(31),O=a.n(x),k=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={tags:[]},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;O.a.ajax({url:"/api/blog/tags",success:function(t){e.setState({tags:t})}}),console.log("sidebar mounted")}},{key:"render",value:function(){var e;return e=this.props.admin?"/admin/posts/":"/posts/",r.a.createElement(j.a,{itemLayout:"horizontal",style:{marginTop:"25px"},dataSource:this.state.tags,renderItem:function(t){return r.a.createElement(j.a.Item,{style:{height:"60px"},align:"left"},r.a.createElement(j.a.Item.Meta,{title:r.a.createElement(y.b,{to:e+t.tag},r.a.createElement("span",null,t.tag))}))}})}}]),t}(r.a.Component),w=a(396),S=a(385),I=a(383),C=a(390),T=a(384),M=a(392),D=a(382),F=(a(258),function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"handleDelete",value:function(){console.log(this.props.index),O.a.ajax({url:"/api/blog/article/"+this.props.index,type:"DELETE",headers:{"x-access-token":localStorage.getItem("token")},success:function(e){console.log(e),window.location.reload(),M.a.info("\u5220\u9664\u6210\u529f")},error:function(e){M.a.info("\u5220\u9664\u5931\u8d25")}})}},{key:"render",value:function(){var e;return e=this.props.admin?r.a.createElement("div",null,r.a.createElement(y.b,{to:"/admin/article/"+this.props.index},r.a.createElement(C.a,{size:"small"},"Edit")),r.a.createElement(D.a,{placement:"topRight",title:"Are you sure to delete this blog?",onConfirm:this.handleDelete.bind(this),okText:"Yes",cancelText:"No"},r.a.createElement(C.a,{size:"small"},"Delete"))):r.a.createElement(y.b,{to:"/article/"+this.props.index},r.a.createElement(C.a,{size:"small"},"Learn more")),r.a.createElement(w.a,{className:"card",style:{backgroundImage:"url(/cloudy-day.png)"}},r.a.createElement(I.a,null,r.a.createElement(T.a,{variant:"h5",component:"h2",style:{marginLeft:"20px"}},this.props.title),r.a.createElement("br",null),r.a.createElement(T.a,{variant:"body2",component:"p",style:{marginLeft:"20px"}},this.props.summary)),r.a.createElement(S.a,{style:{float:"right",marginRight:"20px"}},e))}}]),t}(r.a.Component)),z=a(72),B=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={blogs:[]},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(e,t){var a=this,n="";n="/"===this.props.match.path||"/admin"===this.props.match.path?"":this.props.match.params.category,O.a.ajax({url:"/api/blog/views",data:{tag:n},success:function(e){a.setState({blogs:e})}})}},{key:"componentDidUpdate",value:function(e,t){var a=this;if(this.props.match.url!==e.match.url){var n="";n="/"===this.props.match.path||"/admin"===this.props.match.path?"":this.props.match.params.category,O.a.ajax({url:"/api/blog/views",data:{tag:n},success:function(e){a.setState({blogs:e})}})}}},{key:"render",value:function(){var e;if(this.props.admin){var t=r.a.createElement(v.a,{item:!0,md:12,sm:12,xs:12,align:"center",key:"new"},r.a.createElement(z.a,{type:"primary",style:{display:"inline",width:"80%"},onClick:function(){window.location="/admin/article/new"}},"\u6dfb\u52a0"));e=(e=this.state.blogs.map((function(e){return r.a.createElement(v.a,{item:!0,md:12,sm:12,xs:12,key:e.id},r.a.createElement(F,{title:e.title,summary:e.summary,index:e.id,admin:!0}))}))).concat(t)}else e=this.state.blogs.map((function(e){return r.a.createElement(v.a,{item:!0,md:12,sm:12,xs:12,key:e.id},r.a.createElement(F,{title:e.title,summary:e.summary,index:e.id}))}));return r.a.createElement(v.a,{container:!0,direction:"row",justify:"space-evenly",alignItems:"flex-start",spacing:3},e)}}]),t}(r.a.Component),L=a(170),A=a.n(L),N=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={video:{src:"resources/live.m3u8"}},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("div",{style:{display:"inline-block",marginTop:"20px"}},r.a.createElement(A.a,{autoplay:!0,src:this.state.video.src,height:"420",style:{marginLeft:"20px"}})))}}]),t}(r.a.Component),R=a(171),J=a.n(R),K=a(394),V=a(391),W=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={title:"",tags:[],content:""},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;O.a.ajax({url:"/api/blog/article/"+this.props.index,success:function(t){var a=t;e.setState({title:a.title,tags:a.tags,content:a.content})}})}},{key:"render",value:function(){var e=V.a.Title,t=this.state.tags.map((function(e){var t=Math.floor(16777215*Math.random()).toString(16);return r.a.createElement(K.a,{color:"#"+t,style:{float:"right"},key:e},e)}));return r.a.createElement("div",{style:{padding:"20px 50px 20px",objectFit:"cover",position:"relative"}},r.a.createElement("div",null,r.a.createElement(e,{style:{paddingBottom:"20px",textAlign:"center"}},this.state.title)),r.a.createElement("div",null,t),r.a.createElement("div",{style:{paddingTop:"50px",objectFit:"cover",position:"relative"}},r.a.createElement(J.a,{source:this.state.content,escapeHtml:!1})))}}]),t}(r.a.Component),H=a(393),P=a(387),q=H.a.TextArea,U=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={title:"",tags:[],summary:"",content:""},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){var e=this;"new"!==this.props.index&&O.a.ajax({url:"/api/blog/article/"+this.props.index,async:!1,success:function(t){var a=t;e.setState({title:a.title,tags:a.tags,summary:a.summary,content:a.content})}})}},{key:"handleClick",value:function(){var e=document.getElementById("titleInput").value,t=document.getElementById("tagsInput").value,a=document.getElementById("summaryInput").value,n=document.getElementById("contentInput").value;"new"===this.props.index?O.a.ajax({url:"/api/blog/articles",type:"post",headers:{"Content-Type":"application/json","x-access-token":localStorage.getItem("token")},data:JSON.stringify({title:e,tags:t,summary:a,content:n}),async:!1,success:function(e){alert("\u6dfb\u52a0\u5b8c\u6210\uff01"),window.location="/admin"},error:function(e){alert("\u6dfb\u52a0\u5931\u8d25")}}):O.a.ajax({url:"/api/blog/article/"+this.props.index,type:"put",headers:{"Content-Type":"application/json","x-access-token":localStorage.getItem("token")},data:JSON.stringify({title:e,tags:t,summary:a,content:n}),async:!1,success:function(e){alert("\u4fee\u6539\u5b8c\u6210\uff01"),window.location="/admin"},error:function(e){alert("\u4fee\u6539\u5931\u8d25")}})}},{key:"render",value:function(){var e=this.state.title,t=this.state.content;console.log(t);var a=V.a.Title;return r.a.createElement("div",{style:{padding:"20px 50px 20px",position:"relative"}},r.a.createElement("div",null,r.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u6807\u9898"),r.a.createElement(q,{id:"titleInput",placeholder:"set a title",defaultValue:e,rows:1})),r.a.createElement(P.a,null),r.a.createElement("div",null,r.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u6807\u7b7e"),r.a.createElement(q,{id:"tagsInput",placeholder:"set a title",defaultValue:this.state.tags.join(","),rows:1})),r.a.createElement(P.a,null),r.a.createElement("div",null,r.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u6458\u8981"),r.a.createElement(q,{id:"summaryInput",placeholder:"write summary",defaultValue:this.state.summary,autoSize:{minRows:1,maxRows:3}})),r.a.createElement(P.a,null),r.a.createElement("div",null,r.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u5185\u5bb9"),r.a.createElement(q,{id:"contentInput",placeholder:"markdown here",defaultValue:this.state.content,autoSize:{minRows:8,maxRows:38}})),r.a.createElement("div",{style:{paddingTop:"50px",position:"relative",textAlign:"center"}},r.a.createElement(z.a,{type:"primary",onClick:this.handleClick.bind(this)},"\u63d0\u4ea4"),r.a.createElement(z.a,{type:"primary",style:{marginLeft:"20px"},onClick:function(){window.location="/admin"}},"\u53d6\u6d88")))}}]),t}(r.a.Component),X=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(W,{index:this.props.match.params.id})}}]),t}(r.a.Component),Y=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(U,{index:this.props.match.params.id})}}]),t}(r.a.Component),G=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={content:""},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(v.a,{container:!0,direction:"row",justify:"center",alignItems:"flex-start",spacing:3},r.a.createElement(v.a,{item:!0,md:3,sm:3,xs:12},r.a.createElement("div",{style:{padding:"10px 10px 10px"}},r.a.createElement(k,null))),r.a.createElement(v.a,{item:!0,md:9,sm:9,xs:12},r.a.createElement("div",{style:{padding:"10px 10px 10px"}},r.a.createElement(g.a,{exact:!0,path:["/posts/:category","/"],component:B}))))}}]),t}(r.a.Component),Q=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={content:""},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(v.a,{container:!0,direction:"row",justify:"center",alignItems:"flex-start",spacing:3},r.a.createElement(v.a,{item:!0,md:3,sm:3,xs:12},r.a.createElement("div",{style:{padding:"10px 10px 10px"}},r.a.createElement(k,{admin:!0}))),r.a.createElement(v.a,{item:!0,md:9,sm:9,xs:12},r.a.createElement("div",{style:{padding:"10px 10px 10px"}},r.a.createElement(g.a,{exact:!0,path:["/admin/posts/:category","/admin"],render:function(e){return r.a.createElement(B,Object.assign({},e,{admin:!0}))}}))))}}]),t}(r.a.Component),Z=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(f.a,{maxWidth:"md"},r.a.createElement(E,{admin:!0}),r.a.createElement("div",null,r.a.createElement(g.a,{exact:!0,path:"/admin/article/:id",component:Y}),r.a.createElement(g.a,{exact:!0,path:["/admin/posts/:category","/admin"],component:Q})))}}]),t}(r.a.Component),$=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null)}}]),t}(r.a.Component),_=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(N,null)}}]),t}(r.a.Component),ee=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(f.a,{maxWidth:"md"},r.a.createElement(E,null),r.a.createElement("div",null,r.a.createElement(g.a,{exact:!0,path:"/article/:id",component:X}),r.a.createElement(g.a,{exact:!0,path:["/resources"],component:$}),r.a.createElement(g.a,{exact:!0,path:["/live"],component:_}),r.a.createElement(g.a,{exact:!0,path:["/posts/:category","/"],component:G})))}}]),t}(r.a.Component),te=a(43),ae=a(395),ne=Object(n.createContext)();var re=a(173),ie=a.n(re),ce=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={username:"",password:"",hidden:"hidden"},e.handleSubmit=e.handleSubmit.bind(Object(te.a)(e)),e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=new FormData(e.target);t.set("username",document.getElementById("userInput").value),t.set("password",ie()(document.getElementById("pwdInput").value)),fetch("/api/blog/login",{method:"POST",body:t}).then((function(e){200===e.status?e.json().then((function(e){localStorage.setItem("token",e.token),window.location="/admin"})):alert("login failed")}))}},{key:"render",value:function(){return r.a.createElement(f.a,{maxWidth:"md"},r.a.createElement("form",{ref:"form",onSubmit:this.handleSubmit},r.a.createElement("h1",{style:{fontSize:"18px",textAlign:"center",lineHeight:"50px"}},"Login"),r.a.createElement(H.a,{placeholder:"username",id:"userInput",style:{margin:"10px 10px"}}),r.a.createElement(H.a.Password,{placeholder:"password",id:"pwdInput",style:{margin:"10px 10px"}}),r.a.createElement(z.a,{type:"primary",htmlType:"submit",block:!0,style:{margin:"10px 10px"}},"login")),r.a.createElement(ae.a,{id:"alertMsg",style:{visibility:"hidden"},message:"Error Text",type:"error"}))}}]),t}(r.a.Component);ce.contextType=ne;var le=ce,oe=a(168),se=function(){return r.a.createElement("div",{style:{textAlign:"center",height:"100%"}},r.a.createElement(oe.a,{size:"large",style:{position:"absolute",top:"50%"}}))},ue=a(174),me=a.n(ue),pe=function(){var e=Object(n.useState)({auth:!1,waiting:!0}),t=Object(b.a)(e,2),a=t[0],i=t[1];Object(n.useEffect)((function(){console.log(a.waiting),console.log("auth is "+a.auth),console.log("middle mounted")}));var c=function(){var e=Object(h.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=localStorage.getItem("token"))||i({auth:!1,waiting:!1}),e.next=4,me.a.get("/api/blog/authstate",{headers:{"x-access-token":t}}).then((function(e){200===e.status&&i({auth:!0,waiting:!1})})).catch((function(e){i({auth:!1,waiting:!1})}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.waiting?(c(),r.a.createElement(se,null)):!1!==a.auth?r.a.createElement("div",null,r.a.createElement(g.a,{exact:!0,path:["/admin/resources","/admin/article/*","/admin/posts/*","/admin"],component:Z}),r.a.createElement(g.a,{exact:!0,path:["/live"],component:ee})):void(window.location="/login")},de=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={auth:!1},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{backgroundImage:"url(/blue-snow.png)",backgroundRepeat:"repeat",height:"100%",overflowX:"scroll"}},r.a.createElement(y.a,null,r.a.createElement(g.a,{exact:!0,path:["/admin/resources","/admin/article/*","/admin/posts/*","/admin"],component:pe}),r.a.createElement(g.a,{exact:!0,path:["/resources","/article/*","/posts/*","/"],component:ee}),r.a.createElement(g.a,{exact:!0,path:["/live"],component:pe}),r.a.createElement(g.a,{exact:!0,path:["/login"],component:le})))}}]),t}(r.a.Component);c.a.render(r.a.createElement(de,null),document.querySelector("#root"))}},[[182,1,2]]]);
//# sourceMappingURL=main.e2fa23ad.chunk.js.map