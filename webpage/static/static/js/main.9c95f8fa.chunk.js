(this["webpackJsonpblog-app"]=this["webpackJsonpblog-app"]||[]).push([[0],{181:function(e,t,a){e.exports=a(362)},187:function(e,t,a){},264:function(e,t,a){},362:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(4),c=a.n(i),l=a(18),o=a(13),s=a(19),u=a(20),m=a(21),p=a(124),d=a.n(p),h=a(164),g=a(175),y=a(41),b=a(56),f=a(390),E=a(388),v=(a(187),a(188),a(393)),x=(v.a.Title,function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={current:"blogs"},a.handleClick=function(e){a.setState({current:e.key})},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e,t;return this.props.admin?("/admin",e="\u7ba1\u7406\u5458\u754c\u9762",t="/admin"):(e="",t="/"),r.a.createElement("div",{className:"BlogHeader",style:{backgroundImage:"url(/header.jpg)",backgroundSize:"100% 100%"}},r.a.createElement("div",{style:{position:"absolute",left:"20px",top:"40px"}},r.a.createElement(y.b,{to:t},r.a.createElement("h1",null,e))),r.a.createElement("div",{style:{position:"absolute",bottom:"0px",right:"0px",backgroundColor:"transparent"}},r.a.createElement("div",{className:"MenuFontStyle",onClick:function(){window.location=t}},r.a.createElement("p",{style:{display:"inline",userSelect:"none"}},"Blogs")),r.a.createElement("div",{className:"MenuFontStyle",onClick:function(){window.location="/resources"}},r.a.createElement("p",{style:{display:"inline",userSelect:"none"}},"Resources"))))}}]),t}(r.a.Component)),j=a(391),O=a(28),k=a.n(O),w=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={tags:[]},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;k.a.ajax({url:"/api/blog/tags",success:function(t){e.setState({tags:t})}}),console.log("sidebar mounted")}},{key:"render",value:function(){var e;return e=this.props.admin?"/admin/posts/":"/posts/",r.a.createElement(j.a,{itemLayout:"horizontal",style:{marginTop:"25px"},dataSource:this.state.tags,renderItem:function(t){return r.a.createElement(j.a.Item,{style:{height:"60px"},align:"left"},r.a.createElement(j.a.Item.Meta,{title:r.a.createElement(y.b,{to:e+t.tag},r.a.createElement("span",null,t.tag))}))}})}}]),t}(r.a.Component),I=a(398),S=a(387),C=a(385),T=a(392),M=a(386),D=a(394),z=a(384),B=(a(264),function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"handleDelete",value:function(){console.log(this.props.index),k.a.ajax({url:"/api/blog/article/"+this.props.index,type:"DELETE",headers:{"x-access-token":localStorage.getItem("token")},success:function(e){console.log(e),window.location.reload(),D.a.info("\u5220\u9664\u6210\u529f")},error:function(e){D.a.info("\u5220\u9664\u5931\u8d25")}})}},{key:"render",value:function(){var e;return e=this.props.admin?r.a.createElement("div",null,r.a.createElement(y.b,{to:"/admin/article/"+this.props.index},r.a.createElement(T.a,{size:"small"},"Edit")),r.a.createElement(z.a,{placement:"topRight",title:"Are you sure to delete this blog?",onConfirm:this.handleDelete.bind(this),okText:"Yes",cancelText:"No"},r.a.createElement(T.a,{size:"small"},"Delete"))):r.a.createElement(y.b,{to:"/article/"+this.props.index},r.a.createElement(T.a,{size:"small"},"Learn more")),r.a.createElement(I.a,{className:"card",style:{backgroundImage:"url(/cloudy-day.png)"}},r.a.createElement(C.a,null,r.a.createElement(M.a,{variant:"h5",component:"h2",style:{marginLeft:"20px"}},this.props.title),r.a.createElement("br",null),r.a.createElement(M.a,{variant:"body2",component:"p",style:{marginLeft:"20px"}},this.props.summary)),r.a.createElement(S.a,{style:{float:"right",marginRight:"20px"}},e))}}]),t}(r.a.Component)),F=a(72),R=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={blogs:[]},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(e,t){var a=this,n="";n="/"===this.props.match.path||"/admin"===this.props.match.path?"":this.props.match.params.category,k.a.ajax({url:"/api/blog/views",data:{tag:n},success:function(e){a.setState({blogs:e})}})}},{key:"componentDidUpdate",value:function(e,t){var a=this;if(this.props.match.url!==e.match.url){var n="";n="/"===this.props.match.path||"/admin"===this.props.match.path?"":this.props.match.params.category,k.a.ajax({url:"/api/blog/views",data:{tag:n},success:function(e){a.setState({blogs:e})}})}}},{key:"render",value:function(){var e;if(this.props.admin){var t=r.a.createElement(E.a,{item:!0,md:12,sm:12,xs:12,align:"center",key:"new"},r.a.createElement(F.a,{type:"primary",style:{display:"inline",width:"80%"},onClick:function(){window.location="/admin/article/new"}},"\u6dfb\u52a0"));e=(e=this.state.blogs.map((function(e){return r.a.createElement(E.a,{item:!0,md:12,sm:12,xs:12,key:e.id},r.a.createElement(B,{title:e.title,summary:e.summary,index:e.id,admin:!0}))}))).concat(t)}else e=this.state.blogs.map((function(e){return r.a.createElement(E.a,{item:!0,md:12,sm:12,xs:12,key:e.id},r.a.createElement(B,{title:e.title,summary:e.summary,index:e.id}))}));return r.a.createElement(E.a,{container:!0,direction:"row",justify:"space-evenly",alignItems:"flex-start",spacing:3},e)}}]),t}(r.a.Component),A=a(122),L=a.n(A),N=a(396),J=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={title:"",tags:[],content:""},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;k.a.ajax({url:"/api/blog/article/"+this.props.index,success:function(t){var a=t;e.setState({title:a.title,tags:a.tags,content:a.content})}})}},{key:"render",value:function(){var e=v.a.Title,t=this.state.tags.map((function(e){var t=Math.floor(16777215*Math.random()).toString(16);return console.log(e),r.a.createElement(N.a,{color:"#"+t,style:{float:"right"},key:e},e)}));return r.a.createElement("div",{style:{padding:"20px 50px 20px",objectFit:"cover",position:"relative"}},r.a.createElement("div",null,r.a.createElement(e,{style:{paddingBottom:"20px",textAlign:"center"}},this.state.title)),r.a.createElement("div",null,t),r.a.createElement("div",{style:{paddingTop:"50px",objectFit:"cover",position:"relative"}},r.a.createElement(L.a,{source:this.state.content,escapeHtml:!1})))}}]),t}(r.a.Component),K=a(123),V=a.n(K),W=a(395),H=a(389),P=W.a.TextArea,q=(v.a.Title,function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={title:"",tags:[],summary:"",content:""},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){var e=this;"new"!==this.props.index&&k.a.ajax({url:"/api/blog/article/"+this.props.index,async:!1,success:function(t){var a=t;e.setState({title:a.title,tags:a.tags,summary:a.summary,content:a.content})}})}},{key:"handleClick",value:function(){var e=document.getElementById("titleInput").value,t=document.getElementById("tagsInput").value,a=document.getElementById("summaryInput").value,n=document.getElementById("contentInput").value;"new"===this.props.index?k.a.ajax({url:"/api/blog/articles",type:"post",headers:{"Content-Type":"application/json","x-access-token":localStorage.getItem("token")},data:JSON.stringify({title:e,tags:t,summary:a,content:n}),async:!1,success:function(e){alert("\u6dfb\u52a0\u5b8c\u6210\uff01"),window.location="/admin"},error:function(e){alert("\u6dfb\u52a0\u5931\u8d25")}}):k.a.ajax({url:"/api/blog/article/"+this.props.index,type:"put",headers:{"Content-Type":"application/json","x-access-token":localStorage.getItem("token")},data:JSON.stringify({title:e,tags:t,summary:a,content:n}),async:!1,success:function(e){alert("\u4fee\u6539\u5b8c\u6210\uff01"),window.location="/admin"},error:function(e){alert("\u4fee\u6539\u5931\u8d25")}})}},{key:"render",value:function(){var e=this.state.title,t=this.state.content;console.log(t);var a=v.a.Title;this.state.tags.map((function(e){var t=Math.floor(16777215*Math.random()).toString(16);return console.log(t),r.a.createElement(N.a,{color:"#"+t,style:{float:"right"},key:e},"tag")}));return r.a.createElement("div",{style:{padding:"20px 50px 20px",position:"relative"}},r.a.createElement("div",null,r.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u6807\u9898"),r.a.createElement(P,{id:"titleInput",placeholder:"set a title",defaultValue:e,rows:1})),r.a.createElement(H.a,null),r.a.createElement("div",null,r.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u6807\u7b7e"),r.a.createElement(P,{id:"tagsInput",placeholder:"set a title",defaultValue:this.state.tags.join(","),rows:1})),r.a.createElement(H.a,null),r.a.createElement("div",null,r.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u6458\u8981"),r.a.createElement(P,{id:"summaryInput",placeholder:"write summary",defaultValue:this.state.summary,autoSize:{minRows:1,maxRows:3}})),r.a.createElement(H.a,null),r.a.createElement("div",null,r.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u5185\u5bb9"),r.a.createElement(P,{id:"contentInput",placeholder:"markdown here",defaultValue:this.state.content,autoSize:{minRows:8,maxRows:38}})),r.a.createElement("div",{style:{paddingTop:"50px",position:"relative",textAlign:"center"}},r.a.createElement(F.a,{type:"primary",onClick:this.handleClick.bind(this)},"\u63d0\u4ea4"),r.a.createElement(F.a,{type:"primary",style:{marginLeft:"20px"},onClick:function(){window.location="/admin"}},"\u53d6\u6d88")))}}]),t}(r.a.Component)),U=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(J,{index:this.props.match.params.id})}}]),t}(r.a.Component),X=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(q,{index:this.props.match.params.id})}}]),t}(r.a.Component),Y=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={content:""},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(E.a,{container:!0,direction:"row",justify:"center",alignItems:"flex-start",spacing:3},r.a.createElement(E.a,{item:!0,md:3,sm:3,xs:12},r.a.createElement("div",{style:{padding:"10px 10px 10px"}},r.a.createElement(w,null))),r.a.createElement(E.a,{item:!0,md:9,sm:9,xs:12},r.a.createElement("div",{style:{padding:"10px 10px 10px"}},r.a.createElement(b.a,{exact:!0,path:["/posts/:category","/"],component:R}))))}}]),t}(r.a.Component),G=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={content:""},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(E.a,{container:!0,direction:"row",justify:"center",alignItems:"flex-start",spacing:3},r.a.createElement(E.a,{item:!0,md:3,sm:3,xs:12},r.a.createElement("div",{style:{padding:"10px 10px 10px"}},r.a.createElement(w,{admin:!0}))),r.a.createElement(E.a,{item:!0,md:9,sm:9,xs:12},r.a.createElement("div",{style:{padding:"10px 10px 10px"}},r.a.createElement(b.a,{exact:!0,path:["/admin/posts/:category","/admin"],render:function(e){return r.a.createElement(R,Object.assign({},e,{admin:!0}))}}))))}}]),t}(r.a.Component),Q=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(f.a,{maxWidth:"md"},r.a.createElement(x,{admin:!0}),r.a.createElement("div",null,r.a.createElement(b.a,{exact:!0,path:"/admin/article/:id",component:X}),r.a.createElement(b.a,{exact:!0,path:["/admin/posts/:category","/admin"],component:G})))}}]),t}(r.a.Component),Z=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null)}}]),t}(r.a.Component),$=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(f.a,{maxWidth:"md"},r.a.createElement(x,null),r.a.createElement("div",null,r.a.createElement(b.a,{exact:!0,path:"/article/:id",component:U}),r.a.createElement(b.a,{exact:!0,path:["/resources"],component:Z}),r.a.createElement(b.a,{exact:!0,path:["/posts/:category","/"],component:Y})))}}]),t}(r.a.Component),_=a(44),ee=a(397),te=Object(n.createContext)();var ae=a(174),ne=a.n(ae),re=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={username:"",password:"",hidden:"hidden"},e.handleSubmit=e.handleSubmit.bind(Object(_.a)(e)),e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=new FormData(e.target);t.set("username",document.getElementById("userInput").value),t.set("password",ne()(document.getElementById("pwdInput").value)),fetch("/api/blog/login",{method:"POST",body:t}).then((function(e){200==e.status?e.json().then((function(e){localStorage.setItem("token",e.token),window.location="/admin"})):alert("login failed")}))}},{key:"render",value:function(){return r.a.createElement(f.a,{maxWidth:"md"},r.a.createElement("form",{ref:"form",onSubmit:this.handleSubmit},r.a.createElement("h1",{style:{fontSize:"18px",textAlign:"center",lineHeight:"50px"}},"Login"),r.a.createElement(W.a,{placeholder:"username",id:"userInput",style:{margin:"10px 10px"}}),r.a.createElement(W.a.Password,{placeholder:"password",id:"pwdInput",style:{margin:"10px 10px"}}),r.a.createElement(F.a,{type:"primary",htmlType:"submit",block:!0,style:{margin:"10px 10px"}},"login")),r.a.createElement(ee.a,{id:"alertMsg",style:{visibility:"hidden"},message:"Error Text",type:"error"}))}}]),t}(r.a.Component);re.contextType=te;var ie=re,ce=a(172),le=function(){return r.a.createElement("div",{style:{textAlign:"center",height:"100%"}},r.a.createElement(ce.a,{size:"large",style:{position:"absolute",top:"50%"}}))},oe=function(){var e=Object(n.useState)({auth:!1,waiting:!0}),t=Object(g.a)(e,2),a=t[0],i=t[1];Object(n.useEffect)((function(){console.log(a.waiting),console.log("auth is "+a.auth),console.log("middle mounted")}));var c=function(){var e=Object(h.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=localStorage.getItem("token"))||i({auth:!1,waiting:!1}),e.next=4,V.a.get("/api/blog/authstate",{headers:{"x-access-token":t}}).then((function(e){200==e.status&&i({auth:!0,waiting:!1})})).catch((function(e){i({auth:!1,waiting:!1})}));case 4:e.sent;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.waiting?(c(),r.a.createElement(le,null)):(console.log("finised"),0!=a.auth?r.a.createElement(Q,null):void(window.location="/login"))},se=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={auth:!1},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{backgroundImage:"url(/blue-snow.png)",backgroundRepeat:"repeat",height:"100%",overflowX:"scroll"}},r.a.createElement(y.a,null,r.a.createElement(b.a,{exact:!0,path:["/admin/resources","/admin/article/*","/admin/posts/*","/admin"],component:oe}),r.a.createElement(b.a,{exact:!0,path:["/resources","/article/*","/posts/*","/"],component:$}),r.a.createElement(b.a,{exact:!0,path:["/login"],component:ie})))}}]),t}(r.a.Component);c.a.render(r.a.createElement(se,null),document.querySelector("#root"))}},[[181,1,2]]]);
//# sourceMappingURL=main.9c95f8fa.chunk.js.map