(this["webpackJsonpblog-app"]=this["webpackJsonpblog-app"]||[]).push([[0],{165:function(e,t,a){e.exports=a(269)},171:function(e,t,a){},241:function(e,t,a){},242:function(e,t,a){},243:function(e,t,a){},269:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(4),l=a.n(r),c=a(14),o=a(10),s=a(15),m=a(16),u=a(17),p=a(111),d=a.n(p),h=a(144),b=a(158),g=a(54),y=a(42),f=a(294),v=a(292),E=(a(171),a(172),function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(s.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i)))).state={current:"blogs"},a.handleClick=function(e){a.setState({current:e.key})},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e,t;return this.props.admin?(e="\u7ba1\u7406\u5458\u754c\u9762",t="/admin"):(e="",t="/"),i.a.createElement("div",{className:"BlogHeader",style:{backgroundImage:"url(/header.jpg)",backgroundSize:"100% 100%"}},i.a.createElement("div",{style:{position:"absolute",left:"20px",top:"40px"}},i.a.createElement(y.b,{to:t},i.a.createElement("h1",null,e))),i.a.createElement("div",{style:{position:"absolute",bottom:"0px",right:"10px",backgroundColor:"transparent"}},i.a.createElement("div",{className:"MenuFontStyle",onClick:function(){window.location=t}},i.a.createElement("p",{style:{display:"inline",userSelect:"none"}},"Blogs")),i.a.createElement("div",{className:"MenuFontStyle",onClick:function(){window.location="/resources"}},i.a.createElement("p",{style:{display:"inline",userSelect:"none"}},"Resources")),i.a.createElement("div",{className:"MenuFontStyle",onClick:function(){window.location="/live"}},i.a.createElement("p",{style:{display:"inline",userSelect:"none"}},"Live"))))}}]),t}(i.a.Component)),j=a(295),x=a(28),O=a.n(x),k=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={tags:[]},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;O.a.ajax({url:"/api/blog/tags",success:function(t){e.setState({tags:t})}})}},{key:"render",value:function(){var e;return e=this.props.admin?"/admin/posts/":"/posts/",i.a.createElement(j.a,{itemLayout:"horizontal",style:{marginTop:"1.5em"},dataSource:this.state.tags,renderItem:function(t){return i.a.createElement(j.a.Item,{style:{height:"3.5em"},align:"center"},i.a.createElement(j.a.Item.Meta,{title:i.a.createElement(y.b,{to:e+t.tag},i.a.createElement("span",{style:{fontWeight:"500"}},t.tag))}))}})}}]),t}(i.a.Component),w=a(36),S=a(302),C=a(291),I=a(289),F=a(296),T=a(290),M=a(298),z=a(288),A=(a(241),function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"handleDelete",value:function(){console.log(this.props.index),O.a.ajax({url:"/api/blog/article/"+this.props.index,type:"DELETE",headers:{"x-access-token":localStorage.getItem("token")},success:function(e){console.log(e),window.location.reload(),M.a.info("\u5220\u9664\u6210\u529f")},error:function(e){M.a.info("\u5220\u9664\u5931\u8d25")}})}},{key:"render",value:function(){var e;return e=this.props.admin?i.a.createElement("div",null,i.a.createElement(y.b,{to:"/admin/article/"+this.props.index},i.a.createElement(F.a,{size:"small"},"Edit")),i.a.createElement(z.a,{placement:"topRight",title:"Are you sure to delete this blog?",onConfirm:this.handleDelete.bind(this),okText:"Yes",cancelText:"No"},i.a.createElement(F.a,{size:"small"},"Delete"))):i.a.createElement(y.b,{to:"/article/"+this.props.index},i.a.createElement(F.a,{size:"small"},"Learn more")),i.a.createElement(S.a,{className:"card",style:{backgroundImage:"url(/cloudy-day.png)"}},i.a.createElement(I.a,null,i.a.createElement(T.a,{variant:"h5",component:"h2",style:{marginLeft:"20px",fontSize:"min(6vw, 1.5em)"}},this.props.title),i.a.createElement("br",null),i.a.createElement(T.a,{variant:"body2",component:"p",style:{marginLeft:"20px",fontSize:"min(4vw, 1em)"}},this.props.summary)),i.a.createElement(C.a,{style:{float:"right",marginRight:"20px"}},e))}}]),t}(i.a.Component)),B=a(69),N=(a(242),function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={category:"",limit:0,more:!0,blogs:[]},e.loadMoreArticles=e.loadMoreArticles.bind(Object(w.a)(e)),e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(e,t){var a=this,n="";n="/"===this.props.match.path||"/admin"===this.props.match.path?"":this.props.match.params.category,O.a.ajax({url:"/api/blog/views",data:{tag:n,offset:0,limit:6},success:function(e){a.setState({category:n,limit:e.length,more:!0,blogs:e})}})}},{key:"componentDidUpdate",value:function(e,t){var a=this;if(this.props.match.url!==e.match.url){var n="";n="/"===this.props.match.path||"/admin"===this.props.match.path?"":this.props.match.params.category,O.a.ajax({url:"/api/blog/views",data:{tag:n,offset:0,limit:6},success:function(e){a.setState({category:n,limit:e.length,more:!0,blogs:e})}})}}},{key:"loadMoreArticles",value:function(){var e=this;O.a.ajax({url:"/api/blog/views",data:{tag:this.state.category,offset:this.state.limit,limit:6},success:function(t){6!==t.length?e.setState({limit:e.state.limit+t.length,more:!1,blogs:e.state.blogs.concat(t)}):e.setState({limit:e.state.limit+t.length,blogs:e.state.blogs.concat(t)})}})}},{key:"render",value:function(){var e,t;if(this.props.admin){var a=i.a.createElement(v.a,{item:!0,md:12,sm:12,xs:12,align:"center",key:"new"},i.a.createElement(B.a,{type:"primary",style:{display:"inline",width:"80%"},onClick:function(){window.location="/admin/article/new"}},"\u6dfb\u52a0"));e=(e=this.state.blogs.map((function(e){return i.a.createElement(v.a,{item:!0,md:12,sm:12,xs:12,key:e.id},i.a.createElement(A,{title:e.title,summary:e.summary,index:e.id,admin:!0}))}))).concat(a)}else e=this.state.blogs.map((function(e){return i.a.createElement(v.a,{item:!0,md:12,sm:12,xs:12,key:e.id},i.a.createElement(A,{title:e.title,summary:e.summary,index:e.id}))}));return t=this.state.more?i.a.createElement("div",{className:"ReadMoreFontStyle",style:{marginTop:"1em",marginBottom:"2em",fontSize:"min(5vw, 1.2em)"}},i.a.createElement("span",{onClick:this.loadMoreArticles},"Read More")):i.a.createElement("div",{className:"EndFontStyle",style:{marginTop:"1em",marginBottom:"2em",fontSize:"min(5vw, 1.2em)"}},i.a.createElement("span",null,"Reach the end")),i.a.createElement(v.a,{container:!0,direction:"row",justify:"space-evenly",alignItems:"flex-start",spacing:3},e,t)}}]),t}(i.a.Component)),R=a(153),D=a.n(R),L=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={video:{src:"livesrc/live.m3u8"}},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement("div",{style:{display:"inline-block",paddingTop:"20px"}},i.a.createElement(D.a,{autoplay:!0,src:this.state.video.src,height:"400px"})))}}]),t}(i.a.Component),W=a(300),H=a(297),J=a(154),K=a.n(J),V=(a(243),function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={title:"",tags:[],content:""},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;O.a.ajax({url:"/api/blog/article/"+this.props.index,success:function(t){var a=t;e.setState({title:a.title,tags:a.tags,content:a.content})}})}},{key:"render",value:function(){var e=H.a.Title,t=this.state.tags.map((function(e){var t=Math.floor(16777215*Math.random()).toString(16);return i.a.createElement(W.a,{color:"#"+t,style:{float:"right"},key:e},e)})),a=new K.a.Converter;a.setOption("ghCodeBlocks","true"),a.setOption("disableForced4SpacesIndentedSublists","true");var n=a.makeHtml(this.state.content);return i.a.createElement("div",{style:{padding:"20px 50px 5em",objectFit:"cover",position:"relative",backgroundColor:"#FFFFFF"}},i.a.createElement("div",null,i.a.createElement(e,{style:{paddingBottom:"20px",textAlign:"center"}},this.state.title)),i.a.createElement("div",null,t),i.a.createElement("div",{style:{paddingTop:"50px",objectFit:"cover",position:"relative"}},i.a.createElement("div",{className:"content",id:"article",dangerouslySetInnerHTML:{__html:n}})))}}]),t}(i.a.Component)),P=a(299),_=a(293),q=P.a.TextArea,U=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={title:"",tags:[],summary:"",content:""},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){var e=this;"new"!==this.props.index&&O.a.ajax({url:"/api/blog/article/"+this.props.index,async:!1,success:function(t){var a=t;e.setState({title:a.title,tags:a.tags,summary:a.summary,content:a.content})}})}},{key:"handleClick",value:function(){var e=document.getElementById("titleInput").value,t=document.getElementById("tagsInput").value,a=document.getElementById("summaryInput").value,n=document.getElementById("contentInput").value;"new"===this.props.index?O.a.ajax({url:"/api/blog/articles",type:"post",headers:{"Content-Type":"application/json","x-access-token":localStorage.getItem("token")},data:JSON.stringify({title:e,tags:t,summary:a,content:n}),async:!1,success:function(e){alert("\u6dfb\u52a0\u5b8c\u6210\uff01"),window.location="/admin"},error:function(e){alert("\u6dfb\u52a0\u5931\u8d25")}}):O.a.ajax({url:"/api/blog/article/"+this.props.index,type:"put",headers:{"Content-Type":"application/json","x-access-token":localStorage.getItem("token")},data:JSON.stringify({title:e,tags:t,summary:a,content:n}),async:!1,success:function(e){alert("\u4fee\u6539\u5b8c\u6210\uff01"),window.location="/admin"},error:function(e){alert("\u4fee\u6539\u5931\u8d25")}})}},{key:"render",value:function(){var e=this.state.title,t=this.state.content;console.log(t);var a=H.a.Title;return i.a.createElement("div",{style:{padding:"20px 50px 20px",position:"relative"}},i.a.createElement("div",null,i.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u6807\u9898"),i.a.createElement(q,{id:"titleInput",placeholder:"set a title",defaultValue:e,rows:1})),i.a.createElement(_.a,null),i.a.createElement("div",null,i.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u6807\u7b7e"),i.a.createElement(q,{id:"tagsInput",placeholder:"set a title",defaultValue:this.state.tags.join(","),rows:1})),i.a.createElement(_.a,null),i.a.createElement("div",null,i.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u6458\u8981"),i.a.createElement(q,{id:"summaryInput",placeholder:"write summary",defaultValue:this.state.summary,autoSize:{minRows:1,maxRows:3}})),i.a.createElement(_.a,null),i.a.createElement("div",null,i.a.createElement(a,{level:3,style:{fontFamily:"Kaiti"}},"\u5185\u5bb9"),i.a.createElement(q,{id:"contentInput",placeholder:"markdown here",defaultValue:this.state.content,autoSize:{minRows:8,maxRows:38}})),i.a.createElement("div",{style:{paddingTop:"50px",position:"relative",textAlign:"center"}},i.a.createElement(B.a,{type:"primary",onClick:this.handleClick.bind(this)},"\u63d0\u4ea4"),i.a.createElement(B.a,{type:"primary",style:{marginLeft:"20px"},onClick:function(){window.location="/admin"}},"\u53d6\u6d88")))}}]),t}(i.a.Component),X=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.a.createElement(V,{index:this.props.match.params.id})}}]),t}(i.a.Component),Y=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.a.createElement(U,{index:this.props.match.params.id})}}]),t}(i.a.Component),G=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={content:""},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.a.createElement(v.a,{container:!0,direction:"row",justify:"center",alignItems:"flex-start",spacing:3},i.a.createElement(v.a,{item:!0,md:3,sm:3,xs:12},i.a.createElement("div",{style:{padding:"0.5em 0em 0.5em"}},i.a.createElement(k,null))),i.a.createElement(v.a,{item:!0,md:9,sm:9,xs:12},i.a.createElement("div",{style:{padding:"10px 10px 10px"}},i.a.createElement(g.d,null,i.a.createElement(g.b,{exact:!0,path:["/posts/:category","/"],component:N})))))}}]),t}(i.a.Component),Q=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={content:""},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.a.createElement(v.a,{container:!0,direction:"row",justify:"center",alignItems:"flex-start",spacing:3},i.a.createElement(v.a,{item:!0,md:3,sm:3,xs:12},i.a.createElement("div",{style:{padding:"10px 10px 10px"}},i.a.createElement(k,{admin:!0}))),i.a.createElement(v.a,{item:!0,md:9,sm:9,xs:12},i.a.createElement("div",{style:{padding:"10px 10px 10px"}},i.a.createElement(g.b,{exact:!0,path:["/admin/posts/:category","/admin"],render:function(e){return i.a.createElement(N,Object.assign({},e,{admin:!0}))}}))))}}]),t}(i.a.Component),Z=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.a.createElement(f.a,{maxWidth:"md"},i.a.createElement(E,{admin:!0}),i.a.createElement("div",null,i.a.createElement(g.b,{exact:!0,path:"/admin/article/:id",component:Y}),i.a.createElement(g.b,{exact:!0,path:["/admin/posts/:category","/admin"],component:Q})))}}]),t}(i.a.Component),$=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null)}}]),t}(i.a.Component),ee=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.a.createElement(L,null)}}]),t}(i.a.Component),te=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return console.log(this.props),i.a.createElement(f.a,{maxWidth:"md"},i.a.createElement(E,null),i.a.createElement(g.d,null,i.a.createElement(g.b,{exact:!0,path:"/article/:id",component:X}),i.a.createElement(g.b,{exact:!0,path:["/resources"],component:$}),i.a.createElement(g.b,{exact:!0,path:["/live"],component:ee}),i.a.createElement(g.b,{exact:!0,path:["/posts/:category","/"],component:G})))}}]),t}(i.a.Component),ae=a(301),ne=Object(n.createContext)();var ie=a(156),re=a.n(ie),le=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(m.a)(t).call(this))).state={username:"",password:"",hidden:"hidden"},e.handleSubmit=e.handleSubmit.bind(Object(w.a)(e)),e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=new FormData(e.target);a.set("username",document.getElementById("userInput").value),a.set("password",re()(document.getElementById("pwdInput").value)),fetch("/api/blog/login",{method:"POST",body:a}).then((function(e){200===e.status?e.json().then((function(e){localStorage.setItem("token",e.token),window.location=t.props.location.state.prev})):alert("login failed")}))}},{key:"render",value:function(){return console.log(this.props),i.a.createElement(f.a,{maxWidth:"md"},i.a.createElement("form",{ref:"form",onSubmit:this.handleSubmit},i.a.createElement("h1",{style:{fontSize:"18px",textAlign:"center",lineHeight:"50px"}},"Login"),i.a.createElement(P.a,{placeholder:"username",id:"userInput",style:{margin:"10px 10px"}}),i.a.createElement(P.a.Password,{placeholder:"password",id:"pwdInput",style:{margin:"10px 10px"}}),i.a.createElement(B.a,{type:"primary",htmlType:"submit",block:!0,style:{margin:"10px 10px"}},"login")),i.a.createElement(ae.a,{id:"alertMsg",style:{visibility:"hidden"},message:"Error Text",type:"error"}))}}]),t}(i.a.Component);le.contextType=ne;var ce=le,oe=a(151),se=function(){return i.a.createElement("div",{style:{textAlign:"center",height:"100%"}},i.a.createElement(oe.a,{size:"large",style:{position:"absolute",top:"50%"}}))},me=a(157),ue=a.n(me),pe=function(){var e=Object(n.useState)({auth:!1,waiting:!0}),t=Object(b.a)(e,2),a=t[0],r=t[1];Object(n.useEffect)((function(){console.log(a.waiting),console.log("auth is "+a.auth),console.log("middle mounted")}));var l=function(){var e=Object(h.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=localStorage.getItem("token"))||r({auth:!1,waiting:!1}),e.next=4,ue.a.get("/api/blog/authstate",{headers:{"x-access-token":t}}).then((function(e){200===e.status&&r({auth:!0,waiting:!1})})).catch((function(e){r({auth:!1,waiting:!1})}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(a.waiting)return l(),i.a.createElement(se,null);if(!1===a.auth){var c=window.location.pathname;return i.a.createElement(g.a,{to:{pathname:"/login",state:{prev:c}}})}return i.a.createElement(g.d,null,i.a.createElement(g.b,{exact:!0,path:["/admin/resources","/admin/article/*","/admin/posts/*","/admin"],component:Z}),i.a.createElement(g.b,{exact:!0,path:["/live"],component:te}))},de=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(m.a)(t).call(this,e))).state={auth:!1},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{style:{backgroundImage:"url(/blue-snow.png)",backgroundRepeat:"repeat",height:"100%",overflowX:"scroll"}},i.a.createElement(y.a,null,i.a.createElement(g.d,null,i.a.createElement(g.b,{exact:!0,path:["/admin/resources","/admin/article/*","/admin/posts/*","/admin"],component:pe}),i.a.createElement(g.b,{exact:!0,path:["/resources","/article/*","/posts/*","/"],component:te}),i.a.createElement(g.b,{exact:!0,path:["/live"],component:pe}),i.a.createElement(g.b,{exact:!0,path:["/login"],component:ce}))))}}]),t}(i.a.Component);l.a.render(i.a.createElement(de,null),document.querySelector("#root"))}},[[165,1,2]]]);
//# sourceMappingURL=main.96fbcaf9.chunk.js.map